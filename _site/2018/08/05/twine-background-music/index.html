<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
  <meta charset="utf-8" />
  
  <title>Interactive Storytelling with Twine: Making Background Music Work Even in Chrome</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
  <link rel="stylesheet" href="/assets/css/main.css" />
  <!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
</head>

  <body id="top">
    <!-- Header -->
<header id="header">
  <div class="inner">
    <a href="/" class="image avatar"><img src="/images/avatar.jpg" alt="" /></a>
    
    <h1><strong>Doxanthropos</strong></h1>
    A blog about learning, coding and finding creative ways to do both.

    
  </div>
</header>

    
    <!-- Content = Main -->
    <div id="main">
<section>
    <h1 class="post-title">Interactive Storytelling with Twine: Making Background Music Work Even in Chrome</h1>
  <article class="post-content">
    <p>I will first explain the problem, then show how background music is usually done and at last show how to fix the Chrome issue. If you are only interested in the fix, because you already know the rest, you can jump to <a href="#solving-the-chrome-autoplay-issue">Solving the Chrome Autoplay Issue</a>.</p>

<p>For those who do not know what <a href="http://twinery.org/">Twine</a> is, Liz England has written a <a href="http://www.lizengland.com/blog/2015/03/what-is-twine-for-developers/">good article that answers this question</a>.</p>

<p><strong>TLDL:</strong> To have continuous background music work in Chrome, you ha</p>

<ul>
  <li><a href="#the-problem">The Problem</a></li>
  <li><a href="#background-audio">Background Audio</a></li>
  <li><a href="#solving-the-chrome-autoplay-issue">Solving the Chrome Autoplay Issue</a></li>
</ul>

<h1 id="the-problem">The Problem</h1>

<p>A lot of games and interactive stories utilize background music or sound to generate atmosphere, beginning at the very start of the game.
Sadly Google Chrome, in an effort to stop make the web better, by blocking autoplay for videos and sound, has also blocked any form of music or sound, that would be played before the first player interaction.
They have written about it in two articles:
<a href="https://developers.google.com/web/updates/2017/09/autoplay-policy-changes">Autoplay Policy Changes</a> and <a href="https://blog.google/products/chrome/improving-autoplay-chrome/">Improving Autoplay in Chrome</a>.</p>

<p>The basic change is this: audio and video will not start in Chrome, before the first user interaction happened. An exception to this will be some websites, determined by some self learning algorithm, that will allow autoplay sometimes, based on if the user or many other users already listened to sound or watched video on that site before.</p>

<p>This makes two kinds of people unhappy for seemingly opposing reasons:</p>

<p>One group of people think that autoplay is the devil and should be banned from all websites with no exceptions. These people do not like the self learning exception generator very much.</p>

<p>The other group are the people who have develope(d) games and elearning content for the web, that now lost audio functionality it once had. There are some ways to still have the same effects, like I am showing below for background music in Twine, but these have to be implemented and creators of games and elearning content usually move on to other projects, after completing one. Revisiting all past projects is not an option for most of us.</p>

<p>So to narrow the problem a bit down to the specific aspect promised in the title: There are some easy ways to implement background music in Twine, that have been used and taught for some time, that now do not work anymore.</p>

<h1 id="background-audio">Background Audio</h1>
<p><img src="/images/posts/20180805-story-overview.png" alt="A Storyboard of a small Twine Story with three normal passages and three configuration passages" /></p>

<p>This is the small story that I will use as an example for background music in Twine.</p>

<p>To add music to it you need to first create a folder, where you are goint to export your Story into. I called mine “Twine Projects” and to keep it tidy, I also created a folder inside this project folder, with the name “audio”.
<img src="/images/posts/20180805-folder-structure.png" alt="A folder inside a folder" /></p>

<p>Inside this folder (“audio”) I saved the music, that I want to use in my story. The file has the name <code class="highlighter-rouge">"Daniel_Birch_-_05_-_Sinking_In_The_Rain.mp3"</code>, so to reference this file from the project folder, the path would be <code class="highlighter-rouge">"audio/Daniel_Birch_-_05_-_Sinking_In_The_Rain.mp3"</code>.</p>

<p>To have it play from the beginning, I use some simple lines of JavaScript in the Story JavaScript file:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">backgroundAudio</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'audio'</span><span class="p">);</span>
<span class="nx">backgroundAudio</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">'audio/Daniel_Birch_-_05_-_Sinking_In_The_Rain.mp3'</span><span class="p">;</span>
<span class="nx">backgroundAudio</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">backgroundAudio</span><span class="p">.</span><span class="nx">volume</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">;</span>
<span class="nx">backgroundAudio</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
</code></pre></div></div>
<p>This is basically the way to do it that is show by the DigitalExposure Youtube video <a href="https://www.youtube.com/watch?v=bm9Lvd1Qg4Y">Twine 2.0 - how to Add Music / Tutorial #15</a></p>
<h1 id="solving-the-chrome-autoplay-issue">Solving the Chrome Autoplay Issue</h1>

<p><a href="http://knut.codes/twine/2018-08-background-music/Techniktest.html">before</a></p>

<p><a href="http://knut.codes/twine/2018-08-background-music/Techniktest_for_Chrome.html">after</a></p>

<p>You can download both examples, the one that works in Chrome and the one that does not here as a zip file:</p>
<ul>
  <li><a href="http://knut.codes/twine/2018-08-background-music/2018-08-background-music.zip">Examples</a></li>
</ul>

<h1 id="credits">Credits</h1>

<p>The background music in this example is <a href="http://freemusicarchive.org/music/Daniel_Birch/Ambient_Vol3/Sinking_In_The_Rain">Sinking in the Rain by Daniel Birch</a>.
I got the basics on how to add background music to a Twine story from <a href="https://www.youtube.com/watch?v=bm9Lvd1Qg4Y">Youtube tutorial by DigitalExposureTV</a>.
For the version that also works on Google Chrome:
I learned how to create JavaScript functions that can be accessed from inside a story from a <a href="https://www.youtube.com/watch?v=JjRoHAO6nAQ">Video by Dan Cox</a>.</p>


  </article>
  <p class="post-meta">Aug 5, 2018
    
    
    <a href="/categories/#game-dev">game-dev</a>
    &nbsp;
    
    <a href="/categories/#interactive-storytelling">interactive-storytelling</a>
    &nbsp;
    
    <a href="/categories/#twine">twine</a>
    
    
  </p>
  
</section>
</div>

    
    		<!-- Footer -->
			<footer id="footer">
				<div class="inner">
				  <ul class="icons">
				    <li><a href="/feed.xml" class="icon fa-rss"><span class="label">Feed</span></a></li>
				    
				    <li><a href="https://twitter/doxanthropos" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
				    
				    
				    <li><a href="https://github.com/doxanthropos" class="icon fa-github"><span class="label">Github</span></a></li>
				    
				    
				    
				    <li><a href="mailto:doxanthropos@gmail.com" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
				    
					</ul>
				  <ul class="copyright">
				    
				    <li>&copy; Knut Jackowski</li>
				    
				    <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

    
    
    <!-- Scripts -->
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/jquery.poptrox.min.js"></script>
    <script src="/assets/js/skel.min.js"></script>
    <script src="/assets/js/util.js"></script>
    <!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
    <script src="/assets/js/main.js"></script>
    
  </body>
</html>

